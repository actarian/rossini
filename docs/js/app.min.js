!function(){"use strict";angular.module("app",["ngRoute","jsonFormatter"])}(),function(){"use strict";angular.module("app").config(["$httpProvider",function(e){}])}(),function(){"use strict";angular.module("app").config(["$locationProvider",function(e){e.html5Mode(!0),e.hashPrefix("")}])}(),function(){"use strict";angular.module("app").run(["$rootScope",function(e){}])}(),function(){"use strict";function e(e,o){for(var t=e*o,r=new Uint8Array(t),a=new n,i=1,c=100*Math.random(),s=0;s<4;s++){for(var l=0;l<t;l++){var u=l%e,d=~~(l/e);r[l]+=Math.abs(a.noise(u/i,d/i,c)*i*1.75)}i*=5}return r}function n(){function e(e){return e*e*e*(e*(6*e-15)+10)}function n(e,n,o){return n+e*(o-n)}function o(e,n,o,t){var r=15&e,a=r<8?n:o,i=r<4?o:12==r||14==r?n:t;return(0==(1&r)?a:-a)+(0==(2&r)?i:-i)}for(var t=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)t[256+r]=t[r];return{noise:function(r,a,i){var c=Math.floor(r),s=Math.floor(a),l=Math.floor(i),u=255&c,d=255&s,p=255&l;r-=c,a-=s,i-=l;var g=r-1,h=a-1,w=i-1,m=e(r),f=e(a),E=e(i),v=t[u]+d,H=t[v]+p,b=t[v+1]+p,y=t[u+1]+d,T=t[y]+p,R=t[y+1]+p;return n(E,n(f,n(m,o(t[H],r,a,i),o(t[T],g,a,i)),n(m,o(t[b],r,h,i),o(t[R],g,h,i))),n(f,n(m,o(t[H+1],r,a,w),o(t[T+1],g,a,i-1)),n(m,o(t[b+1],r,h,w),o(t[R+1],g,h,w))))}}}function o(e,n,o){var t=2*Math.random()-1,r=Math.abs(t);return(o?Math.floor(t/r):1)*(e+(n-e)*r)}var t=angular.module("app");Number.prototype.mod=function(e){return(this%e+e)%e};var r=function(){var e=document.createElement("a");return document.body.appendChild(e),e.style="display: none",function(n,o,t,r){t&&(n=r?JSON.stringify(n,null,2):JSON.stringify(n));var a=new Blob([n],{type:"octet/stream"}),i=window.URL.createObjectURL(a);e.href=i,e.download=o,e.click(),window.URL.revokeObjectURL(i)}}();t.directive("scene",[function(){return{restrict:"A",scope:{data:"=scene"},link:function(e,n,t){function r(){function e(){console.log("objects.ribbon.add"),h.add(p)}function n(){console.log("objects.ribbon.remove"),h.remove(p)}function t(){var e=1/y.steps.length/10,n=y.pow,o=(n+e).mod(1),t=y.getCurrentStep(),r=l.getPointAt(n);r.y+=b.cameraHeight,r.y+=t.camera.cameraHeight;var a=l.getPointAt(o);a.y+=b.targetHeight,a.y+=t.camera.targetHeight,w.position.copy(r),w.target.copy(a),w.lookAt(w.target)}function r(){new THREE.Vector2(window.innerWidth,window.innerHeight);return new MeshLineMaterial({color:new THREE.Color(b.colors.lines),lineWidth:5,depthTest:!0})}function a(){T.ribbon.material=r(),T.ribbon.object.material=T.ribbon.material}var i=r(),c=new THREE.Vector3,s=new Array(12).fill(null).map(function(){var e=(new THREE.Vector3).copy(c);return c.x+=o(500,1e3,!0),c.y+=o(50,100,!0),c.z+=o(1e3,2e3,!1),e}),l=new THREE.CatmullRomCurve3(s);l.type="catmullrom";var u=new THREE.Geometry;u.vertices=l.getPoints(1200);var d=new MeshLine;d.setGeometry(u);var p=new THREE.Mesh(d.geometry,i);return e(),w.target=w.target||new THREE.Vector3(0,0,0),{object:p,spline:l,geometry:u,material:i,add:e,remove:n,update:t,updateMaterial:a}}function a(e){function n(){console.log("objects.circles.add"),h.add(u),O.adding=Date.now(),O.removing=!1,O.enabled=!0,O.tween&&O.tween.kill(),O.tween=TweenLite.to(O,O.duration,{pow:1,delay:0,ease:Power2.easeInOut,onComplete:function(){O.adding=!1}})}function o(){console.log("objects.circles.remove"),O.adding=!1,O.removing=Date.now(),O.tween&&O.tween.kill(),O.tween=TweenLite.to(O,O.duration,{pow:0,delay:0,ease:Power2.easeInOut,onComplete:function(){O.removing=!1,O.enabled=!1,h.remove(u)}})}function t(e,n){var o=new THREE.Geometry,t=a(o,n,1),r=null;if(A){var i=new MeshLine;i.setGeometry(o),_.push(o),S.push(i),r=new THREE.Mesh(i.geometry,m)}else r=new THREE.LineLoop(o,p);return M.push(t),j.add(r),r}function r(e,n){var o=new THREE.Geometry,t=a(o,n,2),r=null;if(A){var i=new MeshLine;i.setGeometry(o),x.push(o),L.push(i),r=new THREE.Mesh(i.geometry,f)}else r=new THREE.LineLoop(o,g);return C.push(t),k.add(r),r}function a(n,o,t){return new Array(V).fill(null).map(function(r,a){var i=a/V,c=360*i;c+=60*e,c+=30*t,c+=360/V*.1*o;var s=c*Math.PI/180,l=b.radius,u=0;return u+=o*o*o*.005,r=new THREE.Vector3,r.sincos={base:l,increment:u,radius:l,x:Math.cos(s),y:Math.sin(s)},n.vertices.push(r),r})}function i(e,n,o,t){var r=b.audioStrength,a=b.noiseStrength,i=b.circularStrength,c=d;angular.forEach(n,function(e,n){var s=n%b.bands,l=(V-1-n)%b.bands,u=(c[s]+c[l])/2/b.bands,d=1===t?0:64,p=o*V+(n+d+W)%V,g=o*V+(V-1-n-d+W)%V,h=(b.noiseMap[p]+b.noiseMap[g])/2/64,w=1-(P-o)/P*i,m=e.sincos.base+e.sincos.increment*h+e.sincos.increment*u+a*h*w+r*u*w+0;e.sincos.radius=m,e.x=e.sincos.x*e.sincos.radius,e.y=e.sincos.y*e.sincos.radius,e.z=0}),e.verticesNeedUpdate=!0}function c(){angular.forEach(z,function(e,n){i(e.geometry,M[n],n,1),A&&S[n].setGeometry(_[n])}),angular.forEach(G,function(e,n){i(e.geometry,C[n],n,2),A&&L[n].setGeometry(x[n])}),j.rotation.z+=.001,k.rotation.z-=.001;var n=y.getCurrentStep(),o=T.ribbon.spline.getPointAt((e+.5)/y.steps.length);o.add(n.circle.position),u.position.copy(o),u.scale.x=u.scale.y=u.scale.z=.001+.1*O.pow,u.lookAt(w.position)}function s(){H.color.setHex(b.colors.lines),p.color.setHex(b.colors.lines),g.color.setHex(b.colors.overLines)}var l,u,p=new THREE.LineBasicMaterial({color:b.colors.lines}),g=new THREE.LineBasicMaterial({color:b.colors.overLines}),m=(new THREE.Vector2(window.innerWidth,window.innerHeight),new MeshLineMaterial({color:new THREE.Color(b.colors.lines),lineWidth:1,depthTest:!0})),f=new MeshLineMaterial({color:new THREE.Color(16777215),lineWidth:1,depthTest:!0});u=new THREE.Object3D;var E=y.steps[e],v=(new THREE.TextureLoader).load(E.circle.texture);v.wrapS=THREE.RepeatWrapping,v.wrapT=THREE.RepeatWrapping,v.repeat.set(1,1);var H=new THREE.MeshBasicMaterial({color:16777215,map:v,transparent:!0});l=new THREE.PlaneGeometry(2*b.radius-20,2*b.radius-20,8,8);var R=new THREE.Mesh(l,H);u.add(R);var M=[],C=[],S=[],L=[],_=[],x=[],A=!1,V=b.points,P=b.lines,j=new THREE.Object3D;u.add(j);var k=new THREE.Object3D;u.add(k);var z=new Array(P).fill(null).map(t),G=new Array(P).fill(null).map(r),O={pow:0,duration:.35,enabled:!1,adding:!1,removing:!1},W=0;return{add:n,remove:o,object:u,state:O,update:c,updateMaterial:s}}function i(){d&&(u.getByteFrequencyData(d),angular.forEach(T.circles,function(e){e&&e.state.enabled&&e.update()}))}function c(){R&&R.update(),T.ribbon&&T.ribbon.update(),i(),m.render(h,w)}function s(){g.begin(),c(),g.end(),requestAnimationFrame(s)}var l=e.data;if(l){var u,d,p,g,h,w,m,f,E,v,H,b=l.options,y=l.stepper,T=l.objects,R=null;e.$on("onStep",function(e,n){console.log("onStep",n.current);var o=T.circles[n.current]||a(n.current);o.add(),T.circles[n.current]=o,setTimeout(function(){if(n.previous!==y.current){var e=T.circles[n.previous];e&&e.remove()}},1e3*y.duration),console.log("objects",T)}),e.$on("onOptionsChanged",function(e){p&&(p.volume=b.audioVolume),T.ribbon&&T.ribbon.updateMaterial(),angular.forEach(T.circles,function(e){e&&e.updateMaterial()}),console.log("onOptionsChanged")}),function(){f=window.innerWidth,E=window.innerHeight,v=f/2,H=E/2;var e=f/E;h=new THREE.Scene;var o=new THREE.SphereGeometry(5,32,32),t=new THREE.MeshBasicMaterial({color:16776960}),r=new THREE.Mesh(o,t);h.add(r),w=new THREE.PerspectiveCamera(30,e,.001,2e4),m=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0}),m.setClearColor(0,0),m.setSize(f,E),g=new Stats,n[0].appendChild(m.domElement),n[0].appendChild(g.dom)}(),function(){T.ribbon=r(),T.circles=new Array(y.steps).fill(null)}(),function(){var e,n,o=window.AudioContext||window.webkitAudioContext;e=null,n=new o,u=n.createAnalyser(),p=new Audio,p.src=b.audioUrl,p.controls=!0,p.addEventListener("canplay",function(){var o;return console.log("audio canplay"),e=n.createMediaElementSource(p),e.connect(u),e.connect(n.destination),u.fftSize=2*b.bands,o=u.frequencyBinCount,console.log("bufferLength",o),d=new Uint8Array(o)}),p.volume=b.audioVolume,p.play()}(),function(){function e(){f=window.innerWidth,E=window.innerHeight,v=f/2,H=E/2,m.setSize(f,E),w.aspect=f/E,w.updateProjectionMatrix()}window.addEventListener("resize",e,!1)}(),s()}}}}]),t.controller("RootCtrl",["$scope",function(n){function o(e){var o=new THREE.Color(a.colors.background).getHexString();console.log("backgroundColor",o),document.body.style.backgroundColor="#"+o,n.$broadcast("onOptionsChanged")}function t(e){var o=i.getCurrentStep();o.camera.cameraHeight=a.cameraHeight,o.camera.targetHeight=a.targetHeight,o.circle.position.copy(a.circle.position),n.$broadcast("onChangePositions",o)}var a,i,c,s;c={},a={colors:{background:15395048,lines:3363748,overLines:11845597,notes:3363748},cameraHeight:33,targetHeight:39,camera:{position:new THREE.Vector3,target:new THREE.Vector3},circle:{position:new THREE.Vector3},audioUrl:"audio/rossini-192.mp3",audioVolume:.01,bands:128,points:128,lines:32,radius:200,audioStrength:100,noiseStrength:25,circularStrength:.9,randomize:function(){for(var e=0;e<s.__controllers.length;e++){var n=s.__controllers[e];if(n.__min){var o=n.__min+(n.__max-n.__min)*Math.random();this[n.property]=o,n.updateDisplay()}n.__color&&(n.__color.r=Math.floor(255*Math.random()),n.__color.g=Math.floor(255*Math.random()),n.__color.b=Math.floor(255*Math.random()),n.updateDisplay(),n.setValue(n.__color.hex))}},saveJson:function(){console.log("saveJson"),r(i.steps,"rossini.js",!0,!0)}},a.noiseMap=e(a.points,a.lines),i=function(){function e(e,n){c.tween&&(c.tween.kill(),c.tween=null),c.tween=TweenLite.to(c,c.duration,{pow:e,delay:0,ease:Power2.easeInOut,onComplete:function(){n&&n()}})}function o(o){var t=c.current||0;c.current=o;var r=s[o];a.cameraHeight=r.camera.cameraHeight,a.targetHeight=r.camera.targetHeight,a.circle.position.copy(r.circle.position),n.$broadcast("onStep",{current:o,previous:t}),e(o/s.length,function(){c.tween=null})}function t(){l++,l=Math.min(s.length-1,l),o(l)}function r(){l--,l=Math.max(0,l),o(l)}function i(){return s[l]}var c={pow:0,duration:1.5},s=new Array(24).fill().map(function(e,n){return{id:n+1,name:"Step "+(n+1),camera:{cameraHeight:0,targetHeight:0},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"}}}),l=0;return angular.extend(c,{steps:s,current:l,next:t,previous:r,getCurrentStep:i})}(),n.stepper=i,n.scene={options:a,stepper:i,objects:c},function(){s=new dat.GUI,s.closed=!0,s.add(a,"cameraHeight",20,100).onChange(t),s.add(a,"targetHeight",20,100).onChange(t);var e=s.addFolder("circlePosition");e.add(a.circle.position,"x",-300,300).onChange(t),e.add(a.circle.position,"y",-300,300).onChange(t),e.add(a.circle.position,"z",-300,300).onChange(t);var n=s.addFolder("colors");n.addColor(a.colors,"background").onChange(o),n.addColor(a.colors,"lines").onChange(o),n.addColor(a.colors,"overLines").onChange(o),s.add(a,"audioVolume",.01,1).onChange(o),s.add(a,"audioStrength",10,100).onChange(o),s.add(a,"noiseStrength",10,100).onChange(o),s.add(a,"circularStrength",.01,.9).onChange(o),s.add(a,"randomize"),s.add(a,"saveJson")}(),o()}]),t.controller("___SceneCtrl",["$scope",function(n){function t(e){f&&(f.volume=g.audioVolume);var n=new THREE.Color(g.colors.background).getHexString();console.log("backgroundColor",n),document.body.style.backgroundColor="#"+n,p.ribbon&&p.ribbon.updateMaterial(),angular.forEach(p.circles,function(e){e&&e.updateMaterial()})}function a(e){var n=h.getCurrentStep();n.camera.cameraHeight=g.cameraHeight,n.camera.targetHeight=g.targetHeight,n.circle.position.copy(g.circle.position)}function i(){function e(){console.log("OBJECTS.ribbon.add"),H.add(w)}function n(){console.log("OBJECTS.ribbon.remove"),H.remove(w)}function t(){var e=1/h.steps.length/10,n=h.pow,o=(n+e).mod(1),t=l.getPointAt(n);t.y+=g.cameraHeight;var r=l.getPointAt(o);r.y+=g.targetHeight;var a=h.getCurrentStep();t.y+=a.camera.cameraHeight,r.y+=a.camera.cameraTarget,b.position.copy(t),b.target.copy(r),b.lookAt(b.target)}function r(){new THREE.Vector2(window.innerWidth,window.innerHeight);return new MeshLineMaterial({color:new THREE.Color(g.colors.lines),lineWidth:5,depthTest:!0})}function a(){p.ribbon.material=r(),p.ribbon.object.material=p.ribbon.material}var i=r(),c=new THREE.Vector3,s=new Array(12).fill(null).map(function(){var e=(new THREE.Vector3).copy(c);return c.x+=o(500,1e3,!0),c.y+=o(50,100,!0),c.z+=o(1e3,2e3,!1),e}),l=new THREE.CatmullRomCurve3(s);l.type="catmullrom";var u=new THREE.Geometry;u.vertices=l.getPoints(1200);var d=new MeshLine;d.setGeometry(u);var w=new THREE.Mesh(d.geometry,i);return H.add(w),b.target=b.target||new THREE.Vector3(0,0,0),{object:w,spline:l,geometry:u,material:i,add:e,remove:n,update:t,updateMaterial:a}}function c(e){function n(){console.log("OBJECTS.circles.add"),H.add(u),O.adding=Date.now(),O.removing=!1,O.enabled=!0,O.tween&&O.tween.kill(),O.tween=TweenLite.to(O,O.duration,{pow:1,delay:0,ease:Power2.easeInOut,onComplete:function(){O.adding=!1}})}function o(){console.log("OBJECTS.circles.remove"),O.adding=!1,O.removing=Date.now(),O.tween&&O.tween.kill(),O.tween=TweenLite.to(O,O.duration,{pow:0,delay:0,ease:Power2.easeInOut,onComplete:function(){O.removing=!1,O.enabled=!1,H.remove(u)}})}function t(e,n){var o=new THREE.Geometry,t=a(o,n,1),r=null;if(A){var i=new MeshLine;i.setGeometry(o),_.push(o),S.push(i),r=new THREE.Mesh(i.geometry,f)}else r=new THREE.LineLoop(o,d);return M.push(t),j.add(r),r}function r(e,n){var o=new THREE.Geometry,t=a(o,n,2),r=null;if(A){var i=new MeshLine;i.setGeometry(o),x.push(o),L.push(i),r=new THREE.Mesh(i.geometry,E)}else r=new THREE.LineLoop(o,w);return C.push(t),k.add(r),r}function a(n,o,t){return new Array(V).fill(null).map(function(r,a){var i=a/V,c=360*i;c+=60*e,c+=30*t,c+=360/V*.1*o;var s=c*Math.PI/180,l=g.radius,u=0;return u+=o*o*o*.005,r=new THREE.Vector3,r.sincos={base:l,increment:u,radius:l,x:Math.cos(s),y:Math.sin(s)},n.vertices.push(r),r})}function i(e,n,o,t){var r=g.audioStrength,a=g.noiseStrength,i=g.circularStrength,c=m;angular.forEach(n,function(e,n){var s=n%g.bands,l=(V-1-n)%g.bands,u=(c[s]+c[l])/2/g.bands,d=1===t?0:64,p=o*V+(n+d+W)%V,h=o*V+(V-1-n-d+W)%V,w=(g.noiseMap[p]+g.noiseMap[h])/2/64,m=1-(P-o)/P*i,f=e.sincos.base+e.sincos.increment*w+e.sincos.increment*u+a*w*m+r*u*m+0;e.sincos.radius=f,e.x=e.sincos.x*e.sincos.radius,e.y=e.sincos.y*e.sincos.radius,e.z=0}),e.verticesNeedUpdate=!0}function c(){angular.forEach(z,function(e,n){i(e.geometry,M[n],n,1),A&&S[n].setGeometry(_[n])}),angular.forEach(G,function(e,n){i(e.geometry,C[n],n,2),A&&L[n].setGeometry(x[n])}),j.rotation.z+=.001,k.rotation.z-=.001;var n=h.getCurrentStep(),o=p.ribbon.spline.getPointAt((e+.5)/h.steps.length);o.add(n.circle.position),u.position.copy(o),u.scale.x=u.scale.y=u.scale.z=.001+.1*O.pow,u.lookAt(b.position)}function s(){T.color.setHex(g.colors.lines),d.color.setHex(g.colors.lines),w.color.setHex(g.colors.overLines)}var l,u,d=new THREE.LineBasicMaterial({color:g.colors.lines}),w=new THREE.LineBasicMaterial({color:g.colors.overLines}),f=(new THREE.Vector2(window.innerWidth,window.innerHeight),new MeshLineMaterial({color:new THREE.Color(g.colors.lines),lineWidth:1,depthTest:!0})),E=new MeshLineMaterial({color:new THREE.Color(16777215),lineWidth:1,depthTest:!0});u=new THREE.Object3D;var v=h.steps[e],y=(new THREE.TextureLoader).load(v.circle.texture);y.wrapS=THREE.RepeatWrapping,y.wrapT=THREE.RepeatWrapping,y.repeat.set(1,1);var T=new THREE.MeshBasicMaterial({color:16777215,map:y,transparent:!0});l=new THREE.PlaneGeometry(2*g.radius-20,2*g.radius-20,8,8);var R=new THREE.Mesh(l,T);u.add(R);var M=[],C=[],S=[],L=[],_=[],x=[],A=!1,V=g.points,P=g.lines,j=new THREE.Object3D;u.add(j);var k=new THREE.Object3D;u.add(k);var z=new Array(P).fill(null).map(t),G=new Array(P).fill(null).map(r),O={pow:0,duration:.35,enabled:!1,adding:!1,removing:!1},W=0;return{add:n,remove:o,object:u,state:O,update:c,updateMaterial:s}}function s(){m&&(w.getByteFrequencyData(m),angular.forEach(p.circles,function(e){e&&e.state.enabled&&e.update()}))}function l(){E.begin(),u(),E.end(),requestAnimationFrame(l)}function u(){V&&V.update(),p.tube&&p.tube.update(),p.ribbon&&p.ribbon.update(),s(),C.render(H,b)}function d(){function e(){L=window.innerWidth,_=window.innerHeight,x=L/2,A=_/2,C.setSize(L,_),b.aspect=L/_,b.updateProjectionMatrix()}window.addEventListener("resize",e,!1)}var p={},g={colors:{background:15395048,lines:3363748,overLines:11845597,notes:3363748},cameraHeight:33,targetHeight:39,camera:{position:new THREE.Vector3,target:new THREE.Vector3},circle:{position:new THREE.Vector3},audioUrl:"audio/rossini-192.mp3",audioVolume:.01,bands:128,points:128,lines:32,radius:200,audioStrength:100,noiseStrength:25,circularStrength:.9,randomize:function(){for(var e=0;e<v.__controllers.length;e++){var n=v.__controllers[e];if(n.__min){var o=n.__min+(n.__max-n.__min)*Math.random();this[n.property]=o,n.updateDisplay()}n.__color&&(n.__color.r=Math.floor(255*Math.random()),n.__color.g=Math.floor(255*Math.random()),n.__color.b=Math.floor(255*Math.random()),n.updateDisplay(),n.setValue(n.__color.hex))}},saveJson:function(){console.log("saveJson"),r(h.steps,"rossini.js",!0,!0)}};g.noiseMap=e(g.points,g.lines);var h=function(){function e(e,n){a.tween&&(a.tween.kill(),a.tween=null),a.tween=TweenLite.to(a,a.duration,{pow:e,delay:0,ease:Power2.easeInOut,onComplete:function(){n&&n()}})}function n(n){var o=a.current||0;a.current=n;var t=i[n];g.cameraHeight=t.camera.cameraHeight,g.targetHeight=t.camera.targetHeight,g.circle.position.copy(t.circle.position);var r=p.circles[n]||c(n);r.add(),p.circles[n]=r,e(n/i.length,function(){a.tween=null}),setTimeout(function(){if(o!==a.current){var e=p.circles[o];e&&e.remove()}},1e3*a.duration)}function o(){s++,s=Math.min(i.length-1,s),n(s)}function t(){s--,s=Math.max(0,s),n(s)}function r(){return i[s]}var a={pow:0,duration:1.5},i=new Array(24).fill().map(function(e,n){return{id:n+1,name:"Step "+(n+1),camera:{cameraHeight:0,targetHeight:0},circle:{position:new THREE.Vector3(0,0,0),texture:"img/rossini-01.png"}}}),s=0;return angular.extend(a,{steps:i,current:s,next:o,previous:t,getCurrentStep:r})}();n.stepper=h;var w,m,f,E,v,H,b,y,T,R,M,C,S,L,_,x,A,V=null;!function(){L=window.innerWidth,_=window.innerHeight,T=L/_,x=L/2,A=_/2,y=30,R=.001,M=2e4,H=new THREE.Scene,b=new THREE.PerspectiveCamera(y,T,R,M),b.position.z=100,b.position.y=-500,b.lookAt(new THREE.Vector3(0,0,0)),C=new THREE.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0}),C.setClearColor(0,0),C.setSize(L,_),C.shadowMap.enabled=!0,S=document.getElementById("scene"),S.appendChild(C.domElement),E=new Stats,S.appendChild(E.dom),d()}(),function(){p.ribbon=i(),p.circles=new Array(h.steps).fill(null)}(),function(){var e,n,o=window.AudioContext||window.webkitAudioContext;e=null,n=new o,w=n.createAnalyser(),f=new Audio,f.src=g.audioUrl,f.controls=!0,f.addEventListener("canplay",function(){var o;return console.log("audio canplay"),e=n.createMediaElementSource(f),e.connect(w),e.connect(n.destination),w.fftSize=2*g.bands,o=w.frequencyBinCount,console.log("bufferLength",o),m=new Uint8Array(o)}),f.volume=g.audioVolume,f.play()}(),function(){v=new dat.GUI,v.closed=!0,v.add(g,"cameraHeight",20,100).onChange(a),v.add(g,"targetHeight",20,100).onChange(a);var e=v.addFolder("circlePosition");e.add(g.circle.position,"x",-300,300).onChange(a),e.add(g.circle.position,"y",-300,300).onChange(a),e.add(g.circle.position,"z",-300,300).onChange(a);var n=v.addFolder("colors");n.addColor(g.colors,"background").onChange(t),n.addColor(g.colors,"lines").onChange(t),n.addColor(g.colors,"overLines").onChange(t),v.add(g,"audioVolume",.01,1).onChange(t),v.add(g,"audioStrength",10,100).onChange(t),v.add(g,"noiseStrength",10,100).onChange(t),v.add(g,"circularStrength",.01,.9).onChange(t),v.add(g,"randomize"),v.add(g,"saveJson")}(),t(),l()}])}();
//# sourceMappingURL=app.min.js.map
